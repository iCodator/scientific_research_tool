================================================================================
TESTS MIT INPUT-DATEIEN - DIREKT MIT boolean_parser
================================================================================

Teste deine Queries direkt aus Dateien!

================================================================================
SCHNELLSTART - 3 SCHRITTE
================================================================================

SCHRITT 1: Erstelle test_queries.txt

```
"cancer"[MeSH]
"cancer"[MeSH] AND treatment
"cancer"[MeSH] AND "treatment"[TIAB]
("cancer"[MeSH] OR "tumor"[TIAB])
'tumor'[TIAB]
("cancer"[MeSH] OR treatment) AND "therapy"[TIAB]
"2020-2025"[pdat]
cancer
cancer AND treatment
"search phrase"
cancer AND
AND cancer
```

SCHRITT 2: Teste aus Datei

$ python

>>> from src.core.boolean_parser import parse_query
>>> with open('test_queries.txt', 'r') as f:
...     for line in f:
...         query = line.strip()
...         if query:
...             result = parse_query(query)
...             print(f"{'✅' if result['success'] else '❌'} {query}")

SCHRITT 3: Sieh Ergebnisse

✅ "cancer"[MeSH]
✅ "cancer"[MeSH] AND treatment
✅ "cancer"[MeSH] AND "treatment"[TIAB]
✅ ("cancer"[MeSH] OR "tumor"[TIAB])
✅ 'tumor'[TIAB]
✅ ("cancer"[MeSH] OR treatment) AND "therapy"[TIAB]
✅ "2020-2025"[pdat]
✅ cancer
✅ cancer AND treatment
✅ "search phrase"
❌ cancer AND
❌ AND cancer

================================================================================
METHODE 1: Basis-Test (Einfach)
================================================================================

Speichern als: simple_test.txt

"cancer"[MeSH]
"cancer"[MeSH] AND treatment
cancer AND

Dann:

$ python -c "
from src.core.boolean_parser import parse_query
with open('simple_test.txt') as f:
    for line in f:
        q = line.strip()
        if q:
            r = parse_query(q)
            print(f'{'✅' if r['success'] else '❌'} {q}')
"

================================================================================
METHODE 2: Mit Error-Messages (Detailliert)
================================================================================

$ python

>>> from src.core.boolean_parser import parse_query

>>> with open('test_queries.txt', 'r') as f:
...     for line in f:
...         query = line.strip()
...         if query:
...             result = parse_query(query)
...             status = "✅" if result['success'] else "❌"
...             print(f"{status} {query}")
...             if not result['success']:
...                 print(f"   Error: {result['error']}")
...             else:
...                 print(f"   Tokens: {result['tokens']}")

Resultat:
✅ "cancer"[MeSH]
   Tokens: ['"cancer"[MeSH]']
✅ "cancer"[MeSH] AND treatment
   Tokens: ['"cancer"[MeSH]', 'AND', 'treatment']
❌ cancer AND
   Error: Cannot end with operator: AND

================================================================================
METHODE 3: Speichern der Ergebnisse (Output-Datei)
================================================================================

$ python

>>> from src.core.boolean_parser import parse_query

>>> with open('test_queries.txt', 'r') as infile, open('test_results.txt', 'w') as outfile:
...     for line in infile:
...         query = line.strip()
...         if query:
...             result = parse_query(query)
...             status = "PASS" if result['success'] else "FAIL"
...             outfile.write(f"{status}: {query}\n")
...             if not result['success']:
...                 outfile.write(f"  Error: {result['error']}\n")

>>> exit()

$ cat test_results.txt

Ergebnis in test_results.txt:
PASS: "cancer"[MeSH]
PASS: "cancer"[MeSH] AND treatment
PASS: cancer
FAIL: cancer AND
  Error: Cannot end with operator: AND
FAIL: AND cancer
  Error: Cannot start with operator: AND

================================================================================
METHODE 4: JSON-Format (Automatische Verarbeitung)
================================================================================

$ python

>>> import json
>>> from src.core.boolean_parser import parse_query

>>> results = []
>>> with open('test_queries.txt', 'r') as f:
...     for line in f:
...         query = line.strip()
...         if query:
...             result = parse_query(query)
...             results.append({
...                 'query': query,
...                 'success': result['success'],
...                 'format': result['format'],
...                 'tokens': result['tokens'],
...                 'error': result['error']
...             })

>>> with open('test_results.json', 'w') as f:
...     json.dump(results, f, indent=2)

>>> exit()

$ cat test_results.json

[
  {
    "query": "\"cancer\"[MeSH]",
    "success": true,
    "format": "SINGLE_LINE",
    "tokens": ["\"cancer\"[MeSH]"],
    "error": null
  },
  {
    "query": "cancer AND",
    "success": false,
    "format": "SINGLE_LINE",
    "tokens": [],
    "error": "Cannot end with operator: AND"
  }
]

================================================================================
METHODE 5: Multi-Line Queries (Komplexe Queries)
================================================================================

Erstelle: multiline_queries.txt

```
"cancer"[MeSH]
AND
treatment
---
("cancer"[MeSH] OR "tumor"[TIAB])
AND
("treatment"[TIAB])
---
(("cancer"[MeSH] OR "tumor"[TIAB]) AND "2020-2025"[pdat])
OR
(therapy)
```

Hinweis: Queries werden durch --- getrennt

$ python

>>> from src.core.boolean_parser import parse_query

>>> with open('multiline_queries.txt', 'r') as f:
...     content = f.read().split('---')
...     for i, query_block in enumerate(content, 1):
...         query = query_block.strip()
...         if query:
...             result = parse_query(query)
...             status = "✅" if result['success'] else "❌"
...             print(f"\n[Query {i}] {status}")
...             print(f"Format: {result['format']}")
...             if not result['success']:
...                 print(f"Error: {result['error']}")

Resultat:
[Query 1] ✅
Format: MULTI_LINE

[Query 2] ✅
Format: MULTI_LINE

[Query 3] ✅
Format: MULTI_LINE

================================================================================
METHODE 6: Statistik & Zusammenfassung
================================================================================

$ python

>>> from src.core.boolean_parser import parse_query

>>> stats = {'passed': 0, 'failed': 0, 'errors': {}}

>>> with open('test_queries.txt', 'r') as f:
...     for line in f:
...         query = line.strip()
...         if query:
...             result = parse_query(query)
...             if result['success']:
...                 stats['passed'] += 1
...             else:
...                 stats['failed'] += 1
...                 error = result['error']
...                 stats['errors'][error] = stats['errors'].get(error, 0) + 1

>>> print(f"✅ Passed: {stats['passed']}")
>>> print(f"❌ Failed: {stats['failed']}")
>>> print(f"\nError Types:")
>>> for error, count in stats['errors'].items():
...     print(f"  • {error}: {count}x")

Resultat:
✅ Passed: 10
❌ Failed: 2

Error Types:
  • Cannot end with operator: AND: 1x
  • Cannot start with operator: AND: 1x

================================================================================
METHODE 7: Field-Term Analyse
================================================================================

$ python

>>> from src.core.boolean_parser import parse_query, get_query_info

>>> with open('test_queries.txt', 'r') as f:
...     for line in f:
...         query = line.strip()
...         if query:
...             result = parse_query(query)
...             if result['success']:
...                 info = get_query_info(query)
...                 if info['field_terms']:
...                     print(f"Query: {query}")
...                     print(f"  Field-terms: {info['field_terms']}")
...                     print(f"  Count: {info['num_field_terms']}\n")

Resultat:
Query: "cancer"[MeSH]
  Field-terms: ['"cancer"[MeSH]']
  Count: 1

Query: "cancer"[MeSH] AND treatment
  Field-terms: ['"cancer"[MeSH]']
  Count: 1

Query: "cancer"[MeSH] AND "treatment"[TIAB]
  Field-terms: ['"cancer"[MeSH]', '"treatment"[TIAB]']
  Count: 2

================================================================================
METHODE 8: Expected vs Actual Vergleich
================================================================================

Erstelle: expected_results.txt

```
"cancer"[MeSH] | PASS
"cancer"[MeSH] AND treatment | PASS
cancer | PASS
cancer AND | FAIL
AND cancer | FAIL
cancer AND AND treatment | FAIL
```

$ python

>>> from src.core.boolean_parser import parse_query

>>> matches = 0
>>> mismatches = 0

>>> with open('expected_results.txt', 'r') as f:
...     for line in f:
...         parts = line.strip().split(' | ')
...         if len(parts) == 2:
...             query, expected = parts
...             result = parse_query(query)
...             actual = "PASS" if result['success'] else "FAIL"
...             if actual == expected:
...                 print(f"✅ {query}")
...                 matches += 1
...             else:
...                 print(f"❌ {query}: expected {expected}, got {actual}")
...                 mismatches += 1

>>> print(f"\nMatches: {matches}, Mismatches: {mismatches}")

Resultat:
✅ "cancer"[MeSH]
✅ "cancer"[MeSH] AND treatment
✅ cancer
✅ cancer AND
✅ AND cancer
✅ cancer AND AND treatment

Matches: 6, Mismatches: 0

================================================================================
METHODE 9: CSV-Export für Excel
================================================================================

$ python

>>> import csv
>>> from src.core.boolean_parser import parse_query

>>> with open('test_queries.txt', 'r') as infile, open('test_results.csv', 'w', newline='') as outfile:
...     writer = csv.writer(outfile)
...     writer.writerow(['Query', 'Status', 'Format', 'Error'])
...     for line in infile:
...         query = line.strip()
...         if query:
...             result = parse_query(query)
...             status = 'PASS' if result['success'] else 'FAIL'
...             writer.writerow([
...                 query,
...                 status,
...                 result['format'],
...                 result['error'] or ''
...             ])

>>> exit()

$ cat test_results.csv

Query,Status,Format,Error
"cancer"[MeSH],PASS,SINGLE_LINE,
"cancer"[MeSH] AND treatment,PASS,SINGLE_LINE,
cancer AND,FAIL,SINGLE_LINE,Cannot end with operator: AND

================================================================================
METHODE 10: Performance-Benchmark
================================================================================

$ python

>>> import time
>>> from src.core.boolean_parser import parse_query

>>> with open('test_queries.txt', 'r') as f:
...     queries = [line.strip() for line in f if line.strip()]

>>> print(f"Testing {len(queries)} queries...")
>>> start = time.time()
>>> for query in queries:
...     parse_query(query)
>>> end = time.time()

>>> total_time = end - start
>>> avg_time = (total_time / len(queries)) * 1000

>>> print(f"Total time: {total_time:.4f}s")
>>> print(f"Average: {avg_time:.2f}ms per query")

Resultat:
Testing 12 queries...
Total time: 0.0156s
Average: 1.30ms per query

================================================================================
ALLE METHODEN KOMBINIERT - KOMPLETTES BEISPIEL
================================================================================

$ python

>>> import json
>>> from src.core.boolean_parser import parse_query, get_query_info

>>> results = {
...     'summary': {'passed': 0, 'failed': 0},
...     'tests': []
... }

>>> with open('test_queries.txt', 'r') as f:
...     for line in f:
...         query = line.strip()
...         if query:
...             result = parse_query(query)
...             info = get_query_info(query) if result['success'] else {}
...             
...             test_result = {
...                 'query': query,
...                 'success': result['success'],
...                 'format': result['format'],
...                 'tokens': result['tokens'],
...                 'error': result['error'],
...                 'field_terms': info.get('field_terms', []),
...                 'num_field_terms': info.get('num_field_terms', 0)
...             }
...             
...             results['tests'].append(test_result)
...             if result['success']:
...                 results['summary']['passed'] += 1
...             else:
...                 results['summary']['failed'] += 1
...             
...             status = "✅" if result['success'] else "❌"
...             print(f"{status} {query}")

>>> with open('comprehensive_results.json', 'w') as f:
...     json.dump(results, f, indent=2)

>>> print(f"\nPassed: {results['summary']['passed']}")
>>> print(f"Failed: {results['summary']['failed']}")

================================================================================
ZUSAMMENFASSUNG
================================================================================

SCHNELLSTE METHODE (15 Sekunden):

1. Erstelle test_queries.txt mit Queries

2. Führe aus:
$ python -c "
from src.core.boolean_parser import parse_query
with open('test_queries.txt') as f:
    for line in f:
        q = line.strip()
        if q:
            r = parse_query(q)
            print(f'{'✅' if r['success'] else '❌'} {q}')
"

FERTIG! ✅

================================================================================
Status: ✅ Bereit
Date: December 18, 2025
Time: 18:55 CET

